{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///F:/trade-app-new/trade-app-frontend/new-trade-app/src/app/view-table/page.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { Database, RefreshCw, ArrowLeft, Trophy } from \"lucide-react\";\r\n\r\nconst API_URL = \"http://localhost:8080/api\";\r\n\r\ntype Order = {\r\n  id: number;\r\n  role: string;\r\n  price: number;\r\n  quantity: number;\r\n  trade_date: string;\r\n  trade_time: string;\r\n  transaction_type: number | string;\r\n  created_at: string;\r\n};\r\n\r\ntype TableData = Order[];\r\n\r\nexport default function ViewTablePage() {\r\n  const [tableName, setTableName] = useState(\"\");\r\n  const [data, setData] = useState<TableData>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const table = params.get(\"table\") || \"\";\r\n    setTableName(table);\r\n  }, []);\r\n\r\n  const getTransactionTypeName = (type: number) => {\r\n    if (type === 0) return \"Cash\";\r\n    if (type === 1) return \"Crypto\";\r\n    if (type === 2) return \"Both\";\r\n    return \"Unknown\";\r\n  };\r\n\r\n  const fetchTableData = async () => {\r\n    if (!tableName) return;\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    let endpoint = \"\";\r\n    \r\n    switch(tableName) {\r\n      case \"buyer\":\r\n        endpoint = `${API_URL}/orders/buyer/all`;\r\n        break;\r\n      case \"seller\":\r\n        endpoint = `${API_URL}/orders/seller/all`;\r\n        break;\r\n      case \"top_buyer\":\r\n        endpoint = `${API_URL}/orders/all`; // Will fetch and filter\r\n        break;\r\n      case \"top_seller\":\r\n        endpoint = `${API_URL}/orders/all`; // Will fetch and filter\r\n        break;\r\n      default:\r\n        setError(\"Invalid table name\");\r\n        setLoading(false);\r\n        return;\r\n    }\r\n    \r\n    try {\r\n      const response = await fetch(endpoint);\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        \r\n        let processedData: Order[] = [];\r\n        \r\n        if (tableName === \"top_buyer\") {\r\n          // Fetch from top_buyer table directly\r\n          const topBuyerResponse = await fetch(`${API_URL}/top-orders/all`);\r\n          if (topBuyerResponse.ok) {\r\n            const topResult = await topBuyerResponse.json();\r\n            // Get buyer top orders (contains all transaction types)\r\n            processedData = topResult.top_buyer_0 || [];\r\n            // Add other transaction types\r\n            if (topResult.top_buyer_1) processedData = [...processedData, ...topResult.top_buyer_1];\r\n            if (topResult.top_buyer_2) processedData = [...processedData, ...topResult.top_buyer_2];\r\n          }\r\n        } else if (tableName === \"top_seller\") {\r\n          // Fetch from top_seller table directly\r\n          const topSellerResponse = await fetch(`${API_URL}/top-orders/all`);\r\n          if (topSellerResponse.ok) {\r\n            const topResult = await topSellerResponse.json();\r\n            // Get seller top orders (contains all transaction types)\r\n            processedData = topResult.top_seller_0 || [];\r\n            // Add other transaction types\r\n            if (topResult.top_seller_1) processedData = [...processedData, ...topResult.top_seller_1];\r\n            if (topResult.top_seller_2) processedData = [...processedData, ...topResult.top_seller_2];\r\n          }\r\n        } else {\r\n          // Regular table - get data from result\r\n          if (tableName === \"buyer\" || tableName === \"seller\") {\r\n            processedData = Array.isArray(result) ? result : [];\r\n          }\r\n        }\r\n        \r\n        // Transform transaction_type to readable format\r\n        const transformedData = processedData.map((item: Order) => ({\r\n          ...item,\r\n          transaction_type: getTransactionTypeName(item.transaction_type as number)\r\n        }));\r\n        \r\n        setData(transformedData);\r\n      } else {\r\n        setError(`Failed to fetch data: ${response.statusText}`);\r\n      }\r\n    } catch (err) {\r\n      setError(\"Network error. Please check if backend is running.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (tableName) {\r\n      fetchTableData();\r\n      \r\n      // Auto-refresh every 3 seconds for top tables\r\n      if (tableName.startsWith(\"top_\")) {\r\n        const interval = setInterval(fetchTableData, 3000);\r\n        return () => clearInterval(interval);\r\n      }\r\n    }\r\n  }, [tableName]);\r\n\r\n  const getTableTitle = () => {\r\n    switch(tableName) {\r\n      case \"buyer\": return \"All Buyer Orders (All Transaction Types)\";\r\n      case \"seller\": return \"All Seller Orders (All Transaction Types)\";\r\n      case \"top_buyer\": return \"Top 10 Buyer Orders (Lowest Prices - All Types)\";\r\n      case \"top_seller\": return \"Top 10 Seller Orders (Highest Prices - All Types)\";\r\n      default: return \"Database Table\";\r\n    }\r\n  };\r\n\r\n  const getTableColor = () => {\r\n    switch(tableName) {\r\n      case \"buyer\": return \"text-blue-600\";\r\n      case \"seller\": return \"text-purple-600\";\r\n      case \"top_buyer\": return \"text-blue-600\";\r\n      case \"top_seller\": return \"text-purple-600\";\r\n      default: return \"text-gray-600\";\r\n    }\r\n  };\r\n\r\n  const getBorderColor = () => {\r\n    switch(tableName) {\r\n      case \"top_buyer\": return \"border-blue-500 bg-gradient-to-br from-blue-50 to-white\";\r\n      case \"top_seller\": return \"border-purple-500 bg-gradient-to-br from-purple-50 to-white\";\r\n      default: return \"border-black\";\r\n    }\r\n  };\r\n\r\n  const isTopTable = tableName.startsWith(\"top_\");\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <div className=\"mb-6 flex items-center justify-between\">\r\n          <button\r\n            onClick={() => window.close()}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-white border-2 border-black rounded-lg hover:bg-gray-100 transition-all\"\r\n          >\r\n            <ArrowLeft size={20} />\r\n            <span className=\"font-semibold\">Close</span>\r\n          </button>\r\n          \r\n          <button\r\n            onClick={fetchTableData}\r\n            disabled={loading}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-all disabled:opacity-50\"\r\n          >\r\n            <RefreshCw size={20} className={loading ? \"animate-spin\" : \"\"} />\r\n            <span className=\"font-semibold\">Refresh</span>\r\n          </button>\r\n        </div>\r\n\r\n        <div className={`bg-white rounded-3xl shadow-lg border-2 p-8 ${getBorderColor()}`}>\r\n          <div className=\"flex items-center gap-3 mb-6\">\r\n            {isTopTable ? (\r\n              <Trophy className={`${getTableColor()}`} size={40} />\r\n            ) : (\r\n              <Database className={`${getTableColor()}`} size={40} />\r\n            )}\r\n            <h1 className=\"text-3xl font-bold text-black\">{getTableTitle()}</h1>\r\n            {isTopTable && (\r\n              <span className=\"ml-auto px-3 py-1 bg-yellow-400 text-black text-xs font-bold rounded-full\">\r\n                AUTO-UPDATING\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          {loading && (\r\n            <div className=\"text-center py-12\">\r\n              <RefreshCw className=\"animate-spin mx-auto mb-4 text-gray-400\" size={48} />\r\n              <p className=\"text-gray-600\">Loading data...</p>\r\n            </div>\r\n          )}\r\n\r\n          {error && (\r\n            <div className=\"bg-red-50 border-2 border-red-200 rounded-lg p-6 text-center\">\r\n              <p className=\"text-red-600 font-semibold\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && !error && data.length === 0 && (\r\n            <div className=\"bg-gray-50 border-2 border-gray-200 rounded-lg p-12 text-center\">\r\n              <Database className=\"mx-auto mb-4 text-gray-300\" size={64} />\r\n              <p className=\"text-gray-600 text-lg font-semibold\">No data found</p>\r\n              <p className=\"text-gray-500 text-sm mt-2\">This table is currently empty</p>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && !error && data.length > 0 && (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border-collapse\">\r\n                <thead>\r\n                  <tr className={`border-b-2 ${\r\n                    isTopTable ? \"bg-yellow-100 border-yellow-500\" : \"bg-gray-100 border-black\"\r\n                  }`}>\r\n                    {Object.keys(data[0]).map((key) => (\r\n                      <th\r\n                        key={key}\r\n                        className=\"px-4 py-3 text-left text-sm font-bold text-black uppercase tracking-wider\"\r\n                      >\r\n                        {key.replace(/_/g, ' ')}\r\n                      </th>\r\n                    ))}\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {data.map((row, idx) => (\r\n                    <tr\r\n                      key={idx}\r\n                      className={`border-b border-gray-200 hover:bg-gray-300 transition-colors cursor-pointer ${\r\n                        isTopTable\r\n                          ? idx === 0\r\n                            ? \"bg-yellow-100 font-bold\"\r\n                            : idx < 3\r\n                            ? \"bg-yellow-50\"\r\n                            : \"bg-white\"\r\n                          : idx % 2 === 0\r\n                          ? \"bg-white\"\r\n                          : \"bg-gray-50\"\r\n                      }`}\r\n                    >\r\n                      {Object.values(row).map((value, cellIdx) => (\r\n                        <td\r\n                          key={cellIdx}\r\n                          className={`px-4 py-3 text-sm ${\r\n                            isTopTable && idx === 0 ? \"text-black font-bold\" : \"text-gray-800\"\r\n                          }`}\r\n                        >\r\n                          {value !== null && value !== undefined ? String(value) : '-'}\r\n                        </td>\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n\r\n          {!loading && !error && data.length > 0 && (\r\n            <div className=\"mt-6 text-center text-gray-600 text-sm\">\r\n              Showing {data.length} {data.length === 1 ? 'record' : 'records'}\r\n              {isTopTable && (\r\n                <span className=\"ml-2 text-yellow-600 font-semibold\">\r\n                  (Auto-refreshes every 3 seconds)\r\n                </span>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}